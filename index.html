<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Drive Thru Pull-Ahead Board</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: #ffffff;          /* WHITE BACKGROUND */
      color: #111827;               /* Dark slate text */
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .wrapper {
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 16px;
    }

    .header {
      text-align: center;
    }

    .title {
      font-size: 1.9rem;
      font-weight: 800;
      margin-bottom: 4px;
      letter-spacing: 0.06em;
    }

    .subline {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .top-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: space-between;
      align-items: center;
    }

    .top-group {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    label {
      font-size: 0.9rem;
      margin-right: 4px;
    }

    select {
      font-size: 1rem;
      padding: 4px 8px;
      border-radius: 6px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      color: #111827;
    }

    button {
      font-size: 0.9rem;
      padding: 6px 10px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-weight: 600;
    }

    .btn-primary {
      background: #16a34a;
      color: #ffffff;
    }

    .btn-secondary {
      background: #111827;
      color: #ffffff;
    }

    .btn-danger {
      background: #b91c1c;
      color: #ffffff;
    }

    /* COACH BANNER – TOP, POP-UP */
    .coach-wrapper {
      margin-top: 8px;
      display: flex;
      justify-content: center;
      min-height: 40px; /* reserve space so layout doesn't jump much */
    }

    .coach-banner {
      padding: 10px 18px;
      border-radius: 999px;
      background: #f59e0b; /* solid amber */
      color: #111827;
      text-align: center;
      font-size: 1rem;
      font-weight: 800;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      box-shadow: 0 10px 25px rgba(0,0,0,0.18);
      min-width: min(100%, 480px);

      opacity: 0;
      transform: translateY(-8px);
      visibility: hidden;
      transition: opacity 0.25s ease-out, transform 0.25s ease-out, visibility 0.25s;
    }

    .coach-banner.show {
      opacity: 1;
      transform: translateY(0);
      visibility: visible;
    }

    .coach-banner span.highlight {
      font-weight: 900;
    }

    /* LEAD CAR – CENTERED */
    .lead-row {
      display: flex;
      justify-content: center;
      margin-top: 4px;
    }

    .lead-car-box {
      background: #16a34a;
      border-radius: 16px;
      padding: 14px 20px;
      width: 100%;
      max-width: 420px;
      text-align: center;
      color: #ffffff;
      box-shadow: 0 8px 18px rgba(22,163,74,0.45);
    }

    .lead-label {
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 0.14em;
      margin-bottom: 6px;
    }

    .lead-display {
      font-size: 2.6rem;
      font-weight: 800;
      padding: 8px;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.16);
      margin-bottom: 4px;
    }

    .lead-timer-label {
      font-size: 0.8rem;
      opacity: 0.9;
      letter-spacing: 0.16em;
      margin-top: 2px;
    }

    .lead-timer-display {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 4px;
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      background: #ffffff;     /* base white pill */
      color: #111827;
    }

    /* SPOTS */
    .board {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .spot {
      border-radius: 16px;
      padding: 10px;
      background: #111827; /* MATCH KEYPAD COLOR */
      box-shadow: 0 6px 14px rgba(15,23,42,0.55);
    }

    .spot-label {
      font-size: 1.1rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 4px;
      letter-spacing: 0.1em;
      color: #e5e7eb;
    }

    .spot-display {
      width: 100%;
      min-height: 48px;
      font-size: 2.4rem;
      font-weight: 700;
      text-align: center;
      padding: 6px;
      border-radius: 10px;
      background: #ffffff;
      color: #111827;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      transition: box-shadow 0.18s ease-out, transform 0.18s ease-out;
    }

    /* SELECTED SPOT HIGHLIGHT – WHITE & OBVIOUS */
    .spot-display.spot-selected {
      box-shadow:
        0 0 0 4px #ffffff,
        0 0 18px rgba(255,255,255,0.85);
      transform: translateY(-1px);
    }

    .spot-timer-wrapper {
      text-align: center;
      margin-top: 6px;
    }

    .spot-timer {
      text-align: center;
      font-size: 1.1rem;
      font-weight: 700;
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      background: #ffffff;   /* base white pill */
      color: #111827;
    }

    .spot-actions {
      margin-top: 8px;
      display: flex;
      justify-content: center;
    }

    .spot-actions button {
      font-size: 1rem;       /* bigger text for tablet */
      padding: 8px 18px;     /* bigger hit area */
      border-radius: 999px;  /* pill button */
      box-shadow: 0 6px 14px rgba(22,163,74,0.45);
    }

    /* Timer colors (based on time) */
    .timer-ok {
      background: #ffffff;
      color: #111827;
    }

    .timer-warn {
      background: #facc15;   /* yellow pill */
      color: #111827;
    }

    .timer-danger {
      background: #b91c1c;   /* red pill */
      color: #ffffff;
    }

    /* KEYPAD + NEXT SPOT ROW */
    .keypad-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: flex-start;
      gap: 16px;
      margin-top: 10px;
    }

    .keypad {
      display: grid;
      grid-template-columns: repeat(3, 70px);
      gap: 10px;
      justify-content: center;
    }

    .key-btn {
      font-size: 1.1rem;
      padding: 8px 0;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      background: #111827;
      color: #ffffff;
      box-shadow: 0 4px 10px rgba(15,23,42,0.35);
    }

    .key-btn.wide {
      grid-column: span 2;
    }

    .next-spot-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #next-spot-btn {
      font-size: 1rem;
      padding: 14px 22px;
      border-radius: 16px;
      background: #111827;
      color: #ffffff;
      min-width: 140px;
      box-shadow: 0 8px 18px rgba(15,23,42,0.45);
      white-space: nowrap;
    }

    .metrics-panel {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 8px;
    }

    .metric-card {
      flex: 1 1 150px;
      background: #f9fafb;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 10px;
      min-width: 150px;
      box-shadow: 0 4px 10px rgba(148,163,184,0.25);
    }

    .metric-label {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 4px;
    }

    .metric-value {
      font-size: 1.8rem;
      font-weight: 800;
      color: #111827;
    }

    .metric-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
      margin-top: 4px;
    }

    .footer-note {
      font-size: 0.75rem;
      opacity: 0.7;
      margin-top: 4px;
    }

    .hourly-columns {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 4px 12px;
      font-size: 0.8rem;
      line-height: 1.4;
      margin-top: 4px;
    }

    .hour-label {
      display: flex;
      justify-content: space-between;
    }

    .hour-label span.value {
      font-weight: 700;
    }

    @media (min-width: 900px) {
      .board {
        flex-direction: row;
      }
      .spot {
        flex: 1;
      }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <!-- HEADER -->
    <div class="header">
      <div class="title">DRIVE THRU PULL-AHEAD BOARD</div>
      <div class="subline">3 spots · Guest-first · &lt; 5 seconds per action</div>
    </div>

    <!-- COACH BANNER – TOP, HIDDEN BY DEFAULT -->
    <div class="coach-wrapper">
      <div id="coach-banner" class="coach-banner">
        <span class="highlight">Ready</span> to serve guests – let’s win this lane.
      </div>
    </div>

    <!-- TOP CONTROLS -->
    <div class="top-row">
      <div class="top-group">
        <label for="store-select">Store:</label>
        <select id="store-select">
          <option value="North">North</option>
          <option value="South">South</option>
        </select>
        <label for="shift-select">Shift:</label>
        <select id="shift-select">
          <option value="Morning">Morning (5:00–10:30)</option>
          <option value="Lunch">Lunch (10:30–2:00)</option>
          <option value="Afternoon">Afternoon (2:00–5:00)</option>
          <option value="Dinner">Dinner (5:00–11:00)</option>
        </select>
      </div>

      <div class="top-group">
        <button class="btn-secondary" id="export-btn">Download CSV</button>
        <button class="btn-secondary" id="fullscreen-btn">Fullscreen</button>
        <button class="btn-danger" id="reset-btn">Reset Shift</button>
      </div>
    </div>

    <!-- LEAD CAR -->
    <div class="lead-row">
      <div class="lead-car-box">
        <div class="lead-label">LEAD CAR</div>
        <div id="lead-car-value" class="lead-display">--</div>
        <div class="lead-timer-label">TIME IN SPOT</div>
        <div id="lead-timer" class="lead-timer-display timer-ok">0:00</div>
      </div>
    </div>

    <!-- SPOTS -->
    <div class="board">
      <div class="spot">
        <div class="spot-label">SPOT 1</div>
        <div id="spot1" class="spot-display"></div>
        <div class="spot-timer-wrapper">
          <div id="spot1-timer" class="spot-timer timer-ok">0:00</div>
        </div>
        <div class="spot-actions">
          <button class="btn-primary food-btn" data-spot="0">Food Delivered</button>
        </div>
      </div>
      <div class="spot">
        <div class="spot-label">SPOT 2</div>
        <div id="spot2" class="spot-display"></div>
        <div class="spot-timer-wrapper">
          <div id="spot2-timer" class="spot-timer timer-ok">0:00</div>
        </div>
        <div class="spot-actions">
          <button class="btn-primary food-btn" data-spot="1">Food Delivered</button>
        </div>
      </div>
      <div class="spot">
        <div class="spot-label">SPOT 3</div>
        <div id="spot3" class="spot-display"></div>
        <div class="spot-timer-wrapper">
          <div id="spot3-timer" class="spot-timer timer-ok">0:00</div>
        </div>
        <div class="spot-actions">
          <button class="btn-primary food-btn" data-spot="2">Food Delivered</button>
        </div>
      </div>
    </div>

    <!-- KEYPAD + NEXT SPOT -->
    <div class="keypad-row">
      <div class="keypad" id="keypad">
        <button class="key-btn" data-key="1">1</button>
        <button class="key-btn" data-key="2">2</button>
        <button class="key-btn" data-key="3">3</button>
        <button class="key-btn" data-key="4">4</button>
        <button class="key-btn" data-key="5">5</button>
        <button class="key-btn" data-key="6">6</button>
        <button class="key-btn" data-key="7">7</button>
        <button class="key-btn" data-key="8">8</button>
        <button class="key-btn" data-key="9">9</button>
        <button class="key-btn" data-key="0">0</button>
        <button class="key-btn wide" data-key="clear">Clear</button>
        <button class="key-btn" data-key="back">⌫</button>
      </div>
      <div class="next-spot-container">
        <button class="btn-secondary" id="next-spot-btn">Next Spot ▶</button>
      </div>
    </div>

    <!-- METRICS -->
    <div class="metrics-panel">
      <div class="metric-card">
        <div class="metric-label">Pulled Cars (this shift)</div>
        <div class="metric-value" id="pulled-count">0</div>
      </div>

      <div class="metric-card">
        <div class="metric-label">Current Stack (active spots)</div>
        <div class="metric-value" id="current-stack">0</div>
        <div class="footer-note">Updates automatically when spots are filled/cleared.</div>
      </div>

      <div class="metric-card">
        <div class="metric-label">Peak Stack (this shift)</div>
        <div class="metric-value" id="peak-stack">0</div>
        <div class="footer-note">Highest number of cars pulled at once.</div>
      </div>

      <div class="metric-card">
        <div class="metric-label">Pulled by Hour (6am–10pm)</div>
        <div class="hourly-columns">
          <div class="hour-label"><span>6–7am</span><span class="value" id="pulled-6">0</span></div>
          <div class="hour-label"><span>7–8am</span><span class="value" id="pulled-7">0</span></div>
          <div class="hour-label"><span>8–9am</span><span class="value" id="pulled-8">0</span></div>
          <div class="hour-label"><span>9–10am</span><span class="value" id="pulled-9">0</span></div>
          <div class="hour-label"><span>10–11am</span><span class="value" id="pulled-10">0</span></div>
          <div class="hour-label"><span>11–12pm</span><span class="value" id="pulled-11">0</span></div>
          <div class="hour-label"><span>12–1pm</span><span class="value" id="pulled-12">0</span></div>
          <div class="hour-label"><span>1–2pm</span><span class="value" id="pulled-13">0</span></div>
          <div class="hour-label"><span>2–3pm</span><span class="value" id="pulled-14">0</span></div>
          <div class="hour-label"><span>3–4pm</span><span class="value" id="pulled-15">0</span></div>
          <div class="hour-label"><span>4–5pm</span><span class="value" id="pulled-16">0</span></div>
          <div class="hour-label"><span>5–6pm</span><span class="value" id="pulled-17">0</span></div>
          <div class="hour-label"><span>6–7pm</span><span class="value" id="pulled-18">0</span></div>
          <div class="hour-label"><span>7–8pm</span><span class="value" id="pulled-19">0</span></div>
          <div class="hour-label"><span>8–9pm</span><span class="value" id="pulled-20">0</span></div>
          <div class="hour-label"><span>9–10pm</span><span class="value" id="pulled-21">0</span></div>
        </div>
        <div class="footer-note">Auto-updates when a spot goes from empty → has a car number.</div>
      </div>
    </div>

    <div class="footer-note">
      Window stays guest-focused. Anyone else (expo, runners, leaders) can update spots and counters.
    </div>
  </div>

  <script>
    // ---- STATE ----
    let pulledCount = 0;
    let currentStack = 0;
    let peakStack = 0;

    const spotValues = ["", "", ""];
    const spotStartTimes = [null, null, null]; // ms since epoch
    const spotEmptyState = [true, true, true];

    const hourlyPulls = {};
    for (let h = 6; h <= 21; h++) hourlyPulls[h] = 0;

    // ---- ELEMENTS ----
    const spotDisplays = [
      document.getElementById("spot1"),
      document.getElementById("spot2"),
      document.getElementById("spot3"),
    ];
    const spotTimers = [
      document.getElementById("spot1-timer"),
      document.getElementById("spot2-timer"),
      document.getElementById("spot3-timer"),
    ];

    const pulledCountEl = document.getElementById("pulled-count");
    const currentStackEl = document.getElementById("current-stack");
    const peakStackEl = document.getElementById("peak-stack");

    const resetBtn = document.getElementById("reset-btn");
    const fullscreenBtn = document.getElementById("fullscreen-btn");
    const exportBtn = document.getElementById("export-btn");
    const storeSelect = document.getElementById("store-select");
    const shiftSelect = document.getElementById("shift-select");
    const nextSpotBtn = document.getElementById("next-spot-btn");

    const leadCarValueEl = document.getElementById("lead-car-value");
    const leadTimerEl = document.getElementById("lead-timer");
    const foodButtons = document.querySelectorAll(".food-btn");
    const keypad = document.getElementById("keypad");
    const coachBanner = document.getElementById("coach-banner");

    const hourlyEls = {};
    for (let h = 6; h <= 21; h++) {
      hourlyEls[h] = document.getElementById("pulled-" + h);
    }

    // which spot keypad writes to
    let focusedSpotIndex = 0;

    // Encouragement messages
    const coachMessages = [
      "You’re doing great – keep it up!",
      "Awesome hustle out there!",
      "Keep up the great work!",
      "Guests feel the speed. Nice job!",
      "Fantastic teamwork on the lane!",
      "You’re keeping this line moving!",
      "Strong work. Let’s get the next one!",
      "Organized and fast – love it!"
    ];

    let coachTimeoutId = null;

    // ---- HELPERS ----
    function formatDuration(ms) {
      if (!ms || ms < 0) return "0:00";
      const totalSeconds = Math.floor(ms / 1000);
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      const secStr = seconds.toString().padStart(2, "0");
      return `${minutes}:${secStr}`;
    }

    function applyTimerColor(el, ms) {
      el.classList.remove("timer-ok", "timer-warn", "timer-danger");
      if (!ms || ms < 0 || ms < 120000) {
        el.classList.add("timer-ok");        // < 2:00
      } else if (ms < 180000) {
        el.classList.add("timer-warn");      // 2:00 – 2:59
      } else {
        el.classList.add("timer-danger");    // >= 3:00
      }
    }

    function renderSpots() {
      for (let i = 0; i < 3; i++) {
        spotDisplays[i].textContent = spotValues[i];
        spotDisplays[i].classList.toggle("spot-selected", i === focusedSpotIndex);
      }
    }

    function updateLeadFromSpots() {
      // Lead car is always the car that has been waiting the longest
      let bestIndex = null;
      let bestTime = Infinity;

      for (let i = 0; i < 3; i++) {
        if (spotValues[i] !== "" && spotStartTimes[i] !== null) {
          if (spotStartTimes[i] < bestTime) {
            bestTime = spotStartTimes[i];
            bestIndex = i;
          }
        }
      }

      if (bestIndex !== null) {
        leadCarValueEl.textContent = spotValues[bestIndex];
        return bestIndex;
      } else {
        leadCarValueEl.textContent = "--";
        return null;
      }
    }

    function updateStack() {
      currentStack = spotValues.filter(v => v !== "").length;
      currentStackEl.textContent = currentStack.toString();
      if (currentStack > peakStack) {
        peakStack = currentStack;
        peakStackEl.textContent = peakStack.toString();
      }
      updateLeadFromSpots();
    }

    function updateTimers() {
      const now = Date.now();
      for (let i = 0; i < 3; i++) {
        let elapsed = 0;
        if (spotStartTimes[i] !== null && spotValues[i] !== "") {
          elapsed = now - spotStartTimes[i];
        }
        const text = formatDuration(elapsed);
        spotTimers[i].textContent = text;
        applyTimerColor(spotTimers[i], elapsed);
      }

      const leadIndex = updateLeadFromSpots();
      if (leadIndex !== null &&
          spotStartTimes[leadIndex] !== null &&
          spotValues[leadIndex] !== "") {
        const elapsedLead = now - spotStartTimes[leadIndex];
        leadTimerEl.textContent = formatDuration(elapsedLead);
        applyTimerColor(leadTimerEl, elapsedLead);
      } else {
        leadTimerEl.textContent = "0:00";
        applyTimerColor(leadTimerEl, 0);
      }
    }

    // Run timers every second
    setInterval(updateTimers, 1000);

    function incrementPulledAndHourly() {
      pulledCount += 1;
      pulledCountEl.textContent = pulledCount.toString();

      const now = new Date();
      const hour = now.getHours();
      if (hour >= 6 && hour <= 21) {
        hourlyPulls[hour] += 1;
        if (hourlyEls[hour]) hourlyEls[hour].textContent = hourlyPulls[hour].toString();
      }
    }

    function setSpotValue(index, newValue) {
      const wasEmpty = spotEmptyState[index];
      const nowEmpty = newValue === "";

      if (wasEmpty && !nowEmpty) {
        incrementPulledAndHourly();
        spotStartTimes[index] = Date.now();  // start timer
      } else if (!wasEmpty && nowEmpty) {
        spotStartTimes[index] = null;       // clear timer
      }

      spotEmptyState[index] = nowEmpty;
      spotValues[index] = newValue;
      renderSpots();
      updateStack();
      updateTimers();
    }

    function clearSpot(index) {
      setSpotValue(index, "");
    }

    function resetShift() {
      if (!confirm("Reset shift counters, hourly pulls, and clear all spots?")) return;

      for (let i = 0; i < 3; i++) {
        spotValues[i] = "";
        spotEmptyState[i] = true;
        spotStartTimes[i] = null;
      }
      renderSpots();

      pulledCount = 0;
      currentStack = 0;
      peakStack = 0;
      pulledCountEl.textContent = "0";
      currentStackEl.textContent = "0";
      peakStackEl.textContent = "0";
      leadCarValueEl.textContent = "--";
      leadTimerEl.textContent = "0:00";
      applyTimerColor(leadTimerEl, 0);

      for (let h = 6; h <= 21; h++) {
        hourlyPulls[h] = 0;
        if (hourlyEls[h]) hourlyEls[h].textContent = "0";
      }

      updateTimers();
    }

    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(() => {});
      } else {
        document.exitFullscreen().catch(() => {});
      }
    }

    function downloadCSV() {
      const store = storeSelect.value;
      const shift = shiftSelect.value;
      const now = new Date();
      const iso = now.toISOString();

      const baseHeader = [
        "timestamp","store","shift",
        "pulled_total","current_stack","peak_stack"
      ];
      const hourHeaders = [];
      for (let h = 6; h <= 21; h++) hourHeaders.push(`pulled_${h}_${h+1}`);
      const header = baseHeader.concat(hourHeaders).join(",");

      const baseRow = [
        iso,store,shift,
        pulledCount,currentStack,peakStack
      ];
      const hourValues = [];
      for (let h = 6; h <= 21; h++) hourValues.push(hourlyPulls[h]);
      const row = baseRow.concat(hourValues).join(",");

      const csvContent = header + "\n" + row + "\n";
      const blob = new Blob([csvContent], {type:"text/csv"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      const dateSafe = iso.replace(/[:.]/g,"-");
      a.download = `pull_ahead_${store}_${shift}_${dateSafe}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function showCoachMessage() {
      const msg = coachMessages[Math.floor(Math.random() * coachMessages.length)];
      coachBanner.textContent = msg;

      // Clear any previous timeout
      if (coachTimeoutId !== null) {
        clearTimeout(coachTimeoutId);
        coachTimeoutId = null;
      }

      coachBanner.classList.add("show");

      coachTimeoutId = setTimeout(() => {
        coachBanner.classList.remove("show");
        coachTimeoutId = null;
      }, 3000); // visible for ~3 seconds
    }

    // ---- EVENT WIRING ----
    spotDisplays.forEach((el, idx) => {
      el.addEventListener("click", () => {
        focusedSpotIndex = idx;
        renderSpots();
      });
    });

    foodButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const idx = parseInt(btn.getAttribute("data-spot"), 10);
        clearSpot(idx);
        showCoachMessage();  // banner pops up then auto-hides
      });
    });

    keypad.addEventListener("click", (e) => {
      const btn = e.target;
      if (!btn.classList.contains("key-btn")) return;
      const key = btn.getAttribute("data-key");
      let val = spotValues[focusedSpotIndex];

      if (key === "clear") {
        val = "";
      } else if (key === "back") {
        val = val.slice(0, -1);
      } else {
        if (val.length < 4) val += key;
      }
      setSpotValue(focusedSpotIndex, val);
    });

    nextSpotBtn.addEventListener("click", () => {
      focusedSpotIndex = (focusedSpotIndex + 1) % 3;
      renderSpots();
    });

    resetBtn.addEventListener("click", resetShift);
    fullscreenBtn.addEventListener("click", toggleFullscreen);
    exportBtn.addEventListener("click", downloadCSV);

    // initial render
    renderSpots();
    updateStack();
    updateTimers();
  </script>
</body>
</html>

